(function(){'use strict';angular.module("BBAdmin",["BB","BBAdmin.Services","BBAdmin.Filters","BBAdmin.Directives","BBAdmin.Controllers","BBAdmin.Models","BBAdmin.Directives","trNgGrid"]),angular.module("BBAdmin.Directives",[]),angular.module("BBAdmin.Filters",[]),angular.module("BBAdmin.Models",[]),angular.module("BBAdmin.Services",["ngResource","ngSanitize"]),angular.module("BBAdmin.Controllers",["ngSanitize"])}).call(this),function(){'use strict';angular.module("BBAdmin").config(["$logProvider",function(e){'ngInject';e.debugEnabled(!0)}]),angular.module("BB").config(["FormTransformProvider",function(e){'ngInject';e.setTransform("edit","Admin_Booking",function(e,t,o){var i;return i=o&&3===o.status?["service","person_id","resource_id"]:["datetime","service","person_id","resource_id"],e[0].tabs?_.each(e[0].tabs[0].items,function(e){if(-1<_.indexOf(i,e.key))return e.readonly=!0}):_.each(e,function(e){if(-1<_.indexOf(i,e.key))return e.readonly=!0}),e})}])}.call(this),function(){'use strict';angular.module("BBAdmin.Services").run(["$q","$injector","BBModel",function(e,t,o){'ngInject';var n,a,r,d,l;for(l=["Booking","Slot","User","Administrator","Schedule","Address","Resource","Person","Service","Login","EventChain","EventGroup","Event","Clinic","Company","Client"],n={},(a=0,r=l.length);a<r;a++)d=l[a],n[d]=t.get("Admin"+d+"Model");o.Admin=n}])}.call(this),function(){'use strict';var e=function(e,o){function i(){this.constructor=e}for(var n in o)t.call(o,n)&&(e[n]=o[n]);return i.prototype=o.prototype,e.prototype=new i,e.__super__=o.prototype,e},t={}.hasOwnProperty;window.Collection.Booking=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.checkItem=function(){return o.__super__.checkItem.apply(this,arguments)},o.prototype.matchesParams=function(e){return!(null!=this.params.start_date&&e.start&&(null==this.start_date&&(this.start_date=moment(this.params.start_date)),this.start_date.isAfter(e.start)))&&!(null!=this.params.end_date&&e.start&&(null==this.end_date&&(this.end_date=moment(this.params.end_date)),this.end_date.isBefore(e.start.clone().startOf("day"))))&&(this.params.include_cancelled||!e.is_cancelled)},o}(window.Collection.Base),angular.module("BB.Services").provider("BookingCollections",function(){return{$get:function(){return new window.BaseCollections}}})}.call(this),function(){'use strict';var e=function(e,o){function i(){this.constructor=e}for(var n in o)t.call(o,n)&&(e[n]=o[n]);return i.prototype=o.prototype,e.prototype=new i,e.__super__=o.prototype,e},t={}.hasOwnProperty;window.Collection.Client=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.checkItem=function(){return o.__super__.checkItem.apply(this,arguments)},o}(window.Collection.Base),angular.module("BB.Services").provider("ClientCollections",function(){return{$get:function(){return new window.BaseCollections}}})}.call(this),function(){'use strict';var e=function(e,o){function i(){this.constructor=e}for(var n in o)t.call(o,n)&&(e[n]=o[n]);return i.prototype=o.prototype,e.prototype=new i,e.__super__=o.prototype,e},t={}.hasOwnProperty;window.Collection.Slot=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.checkItem=function(){return o.__super__.checkItem.apply(this,arguments)},o.prototype.matchesParams=function(e){return!(this.params.start_date&&(this.start_date||(this.start_date=moment(this.params.start_date)),this.start_date.isAfter(e.date)))&&!(this.params.end_date&&(this.end_date||(this.end_date=moment(this.params.end_date)),this.end_date.isBefore(e.date)))},o}(window.Collection.Base),angular.module("BB.Services").provider("SlotCollections",function(){return{$get:function(){return new window.BaseCollections}}})}.call(this),function(){'use strict';angular.module("BBAdmin.Controllers").controller("CalendarCtrl",["$scope","BBModel","$rootScope",function(e,t){return e.eventsF=function(o,i,n,a){var r,d;return d={company_id:21},d.start_date=o.format("YYYY-MM-DD"),d.end_date=i.format("YYYY-MM-DD"),r=t.Admin.Booking.$query(d),r.then(function(){return function(t){return a(t.items),t.addCallback(function(t){return e.myCalendar.fullCalendar("renderEvent",t,!0)})}}(this))},e.dayClick=function(t){return e.$apply(function(){return function(){return e.alertMessage="Day Clicked "+t}}(this))},e.alertOnDrop=function(t,o){return e.$apply(function(){return function(){return e.popupTimeAction({action:"move",booking:t,newdate:t.start,onCancel:o})}}(this))},e.alertOnResize=function(){return e.$apply(function(){return function(){return e.alertMessage="Event Resized "}}(this))},e.addRemoveEventSource=function(e,t){var o;if(o=0,angular.forEach(e,function(){return function(i,n){if(e[n]===t)return e.splice(n,1),o=1}}(this)),0===o)return e.push(t)},e.addEvent=function(){var t,o;return o="",t="",e.events.push({title:"Open Sesame",start:new Date(o,t,28),end:new Date(o,t,29),className:["openSesame"]})},e.remove=function(t){return e.events.splice(t,1)},e.changeView=function(t){return e.myCalendar.fullCalendar("changeView",t)},e.eventClick=function(t){return e.$apply(function(){return function(){return e.selectBooking(t)}}(this))},e.selectTime=function(t,o,i){return e.$apply(function(){return function(){return e.popupTimeAction({start_time:moment(t),end_time:moment(o),allDay:i}),e.myCalendar.fullCalendar("unselect")}}(this))},e.uiConfig={calendar:{height:450,editable:!0,header:{left:"month agendaWeek agendaDay",center:"title",right:"today prev,next"},dayClick:e.dayClick,eventClick:e.eventClick,eventDrop:e.alertOnDrop,eventResize:e.alertOnResize,selectable:!0,selectHelper:!0,select:e.selectTime}},e.eventSources=[e.eventsF]}])}.call(this),function(){'use strict';angular.module("BBAdmin.Controllers").controller("CategoryList",["$scope","$location","$rootScope","BBModel",function(e,t,o,i){return o.connection_started.then(function(){return function(){return e.categories=i.Category.$query(e.bb.company),e.categories.then(function(){})}}(this)),e.$watch("selectedCategory",function(){return function(e){var t;return o.category=e,t=$(".inline_time").each(function(t,o){return angular.element(o).scope().clear()})}}(this)),e.$on("Refresh_Cat",function(){return function(){return e.$apply()}}(this))}])}.call(this),function(){'use strict';angular.module("BBAdmin.Directives").directive("bbAdminClients",function(){return{restrict:"AE",replace:!0,scope:!0,controller:"AdminClients",link:function(){}}}),angular.module("BBAdmin.Controllers").controller("AdminClients",["$scope","$rootScope","$q","$log","AlertService","LoadingService","BBModel",function(e,t,o,i,n,a,r){var d;return e.clientDef=o.defer(),e.clientPromise=e.clientDef.promise,e.per_page=15,e.total_entries=0,e.clients=[],d=a.$loader(e),e.getClients=function(i,n,a,l,s){var c;return c=o.defer(),t.connection_started.then(function(){var t;return d.notLoaded(),t={company:e.bb.company,per_page:e.per_page,page:i+1,filter_by:n,filter_by_fields:a,order_by:l,order_by_reverse:s},r.Admin.Client.$query(t).then(function(){return function(t){return e.clients=t.items,d.setLoaded(),e.setPageLoaded(),e.total_entries=t.total_entries,c.resolve(t.items)}}(this),function(e){return c.reject(e),d.setLoadedAndShowError(e,"Sorry, something went wrong")})}),!0},e.edit=function(){return i.info("not implemented")}}])}.call(this),function(){'use strict';angular.module("BBAdmin.Controllers").controller("CompanyList",["$scope","$rootScope","$location",function(e,t,o){return e.selectedCategory=null,t.connection_started.then(function(){return function(){var t,o,i,n;for(o=moment(),e.current_date=o,e.companies=e.bb.company.companies,e.companies&&0!==e.companies.length||(e.companies=[e.bb.company]),e.dates=[],i=moment(o).add(21,"days"),e.end_date=i,t=moment(o),n=[];t.isBefore(i);)e.dates.push(t.clone()),n.push(t.add(1,"days"));return n}}(this)),e.selectCompany=function(e){return o="/view/dashboard/pick_company/"+e.id},e.advance_date=function(t){var o,i,n;for(i=e.current_date.add(t,"days"),e.end_date=moment(i).add(21,"days"),e.current_date=moment(i),e.dates=[],o=i.clone(),n=[];o.isBefore(e.end_date);)e.dates.push(o.clone()),n.push(o.add(1,"days"));return n},e.$on("Refresh_Comp",function(){return e.$apply()})}])}.call(this),function(){'use strict';angular.module("BBAdmin.Controllers").controller("DashboardContainer",["$scope","$rootScope","$location","$uibModal","$document",function(e,t,o,i){var n;return e.selectedBooking=null,e.poppedBooking=null,e.selectBooking=function(t){return e.selectedBooking=t},e.popupBooking=function(t){var o;return e.poppedBooking=t,o=i.open({templateUrl:"full_booking_details",controller:n,scope:e,backdrop:!0,resolve:{items:function(){return function(){return{booking:t}}}(this)}}),o.result.then(function(){return function(t){return e.selected=t}}(this),function(){return function(){return console.log("Modal dismissed at: "+new Date)}}(this))},n=function(e,t,o){return angular.extend(e,o),e.ok=function(){return o.booking&&o.booking.self&&o.booking.$update(),t.close()},e.cancel=function(){return t.dismiss("cancel")}},e.popupTimeAction=function(t){var o;return o=i.open({templateUrl:e.partial_url+"time_popup",controller:n,scope:e,backdrop:!1,resolve:{items:function(){return function(){return t}}(this)}})}}])}.call(this),function(){'use strict';angular.module("BBAdmin.Controllers").controller("DashDayList",["$scope","$rootScope","$q","BBModel",function(t,o,i,e){return t.init=function(){return function(o){var n,a,r,d;return t.inline_items="",o&&(t.bb.company_id=o),t.current_date||(t.current_date=moment().startOf("month")),n=t.current_date,r={date:n.format("DD-MM-YYYY"),company_id:t.bb.company_id},t.service_id&&(r.service_id=t.service_id),t.end_date&&(r.edate=t.end_date.format("DD-MM-YYYY")),a=i.defer(),d=i.defer(),t.dayList=a.promise,t.weeks=d.promise,r.url=t.bb.api_url,e.Admin.Day.$query(r).then(function(e){if(t.sdays=e,a.resolve(),t.category)return t.update_days()})}}(this),t.format_date=function(){return function(e){return t.current_date.format(e)}}(this),t.selectDay=function(){return function(o,i,n){var e,a,r;return 0!==o.spaces&&(a=moment(t.current_date),a.date(o.day),t.selected_date=a,e=angular.element(n.toElement),e.parent().children().removeClass("selected"),e.addClass("selected"),r=$("#tl_"+t.bb.company_id),t.service_id=i.service_id,t.service={id:i.service_id,name:i.name},t.selected_day=o,0===r.length?t.inline_items="/view/dash/time_small":r.scope().init(o))}}(this),t.$watch("current_date",function(){return function(e){if(e&&t.bb.company_id)return t.init()}}(this)),t.update_days=function(){return function(){var e,o,n,a,r;for(t.dayList=[],t.service_id=null,a=t.sdays,r=[],(o=0,n=a.length);o<n;o++)e=a[o],e.category_id===t.category.id?(t.dayList.push(e),r.push(t.service_id=e.id)):r.push(void 0);return r}}(this),o.$watch("category",function(){return function(e){if(e&&t.sdays)return t.update_days()}}(this))}])}.call(this),function(){'use strict';angular.module("BBAdmin.Controllers").controller("EditBookingDetails",["$scope","$location","$rootScope",function(){}])}.call(this),function(){'use strict';angular.module("BBAdmin.Directives").directive("bbAdminLogin",function(){return{restrict:"AE",replace:!0,scope:{onSuccess:"=",onCancel:"=",onError:"=",bb:"="},controller:"AdminLogin",template:"<div ng-include=\"login_template\"></div>"}}),angular.module("BBAdmin.Controllers").controller("AdminLogin",["$scope","$rootScope","$q","$sessionStorage","BBModel",function(e,t,o,i,n){return e.login_data={host:i.getItem("host"),email:null,password:null,selected_admin:null},e.login_template="login/admin_login.html",e.login=function(){var t;return e.alert="",t={email:e.login_data.email,password:e.login_data.password},n.Admin.Login.$login(t).then(function(t){return null==t.company_id?t.$getAdministrators().then(function(t){return e.administrators=t,e.pickCompany()}):(e.user=t,e.onSuccess)?e.onSuccess():void 0},function(){return e.alert="Sorry, either your email or password was incorrect"})},e.pickCompany=function(){return e.login_template="login/admin_pick_company.html"},e.selectedCompany=function(){var t;return e.alert="",t={email:e.login_data.email,password:e.login_data.password},e.login_data.selected_admin.$post("login",{},t).then(function(){return e.login_data.selected_admin.$getCompany().then(function(t){return e.bb.company=t,n.Admin.Login.$setLogin(e.login_data.selected_admin),e.onSuccess(t)})})}}])}.call(this),function(){'use strict';angular.module("BBAdmin.Controllers").controller("SelectedBookingDetails",["$scope","$location","$rootScope","BBModel",function(e){return e.$watch("selectedBooking",function(){return function(t){if(t)return e.booking=t,e.showItemView="/view/dash/booking_details"}}(this))}])}.call(this),function(){'use strict';angular.module("BBAdmin.Controllers").controller("DashTimeList",["$scope","$rootScope","$location","$q","$element","AdminTimeService",function(e,t,o,i,n,a){var r;return r=null,e.init=function(){return function(t){var o,r,d;return e.selected_day=t,o=angular.element(n),o.attr("id","tl_"+e.bb.company_id),angular.element(n).show(),r={company_id:e.bb.company_id,day:t},e.service_id&&(r.service_id=e.service_id),d=i.defer(),e.slots=d.promise,r.url=e.bb.api_url,e.aslots=a.query(r),e.aslots.then(function(t){var o,n,a,r,l,s,c;for(e.loaded=!0,l={},(o=0,a=t.length);o<a;o++)s=t[o],l[s.time]||(l[s.time]=s);for(n in c=[],l)r=l[n],c.push(r);return d.resolve(c)})}}(this),e.selected_day&&e.init(e.selected_day),e.format_date=function(){return function(t){return e.selected_date.format(t)}}(this),e.selectSlot=function(){return function(t,i){return e.pickTime(t.time),e.pickDate(e.selected_date),o.path(i)}}(this),e.highlighSlot=function(){return function(t){return e.pickTime(t.time),e.pickDate(e.selected_date),e.setCheckout(!0)}}(this),e.clear=function(){return function(){return e.loaded=!1,e.slots=null,angular.element(n).hide()}}(this),e.popupCheckout=function(){return function(t){var o,i,n,a,r,d,l,s,c,m;for(r in a={time:t.time,date:e.selected_day.date,company_id:e.bb.company_id,duration:30,service_id:e.service_id,event_id:t.id},l="/booking/new_checkout?",a)s=a[r],l+=r+"="+s+"&";return m=$(window).width(),i=.8*m,c=$(window).height(),o=.8*c,n=$("#dialog-modal"),d=n.html("<iframe frameborder=0 id='mod_dlg' onload='nowait();setTimeout(set_iframe_focus, 100);' width=100% height=99% src='"+l+"'></iframe>"),n.attr("title","Checkout"),n.dialog({my:"top",at:"top",height:o,width:i,modal:!0,overlay:{opacity:.1,background:"black"}})}}(this)}])}.call(this),function(){'use strict';angular.module("BBAdmin.Controllers").controller("TimeOptions",["$scope","$location","$rootScope","BBModel",function(e,t,o,i){return i.Admin.Resource.$query({company:e.bb.company}).then(function(t){return e.resources=t}),i.Admin.Person.$query({company:e.bb.company}).then(function(t){return e.people=t}),e.block=function(){var t;return e.person&&(t={start_time:e.start_time,end_time:e.end_time},i.Admin.Person.$block(e.bb.company,e.person,t)),e.ok()}}])}.call(this),function(){'use strict';angular.module("BBAdmin.Directives").directive("adminLogin",["$uibModal","$log","$rootScope","$q","$document","BBModel",function(e,t,o,i,n,a){var r,d,l;return d=function(e,t,o){return e.title="Login",e.schema={type:"object",properties:{email:{type:"string",title:"Email"},password:{type:"string",title:"Password"}}},e.form=[{key:"email",type:"email",feedback:!1,autofocus:!0},{key:"password",type:"password",feedback:!1}],e.login_form={},e.submit=function(e){var i;return i={company_id:o},a.Admin.Login.$login(e,i).then(function(o){return o.email=e.email,o.password=e.password,t.close(o)},function(e){return t.dismiss(e)})},e.cancel=function(){return t.dismiss("cancel")}},l=function(e,t,o){var n;return e.title="Pick Company",e.schema={type:"object",properties:{company_id:{type:"integer",title:"Company"}}},e.schema.properties.company_id["enum"]=function(){var e,t,a;for(a=[],e=0,t=o.length;e<t;e++)n=o[e],a.push(n.id);return a}(),e.form=[{key:"company_id",type:"select",titleMap:function(){var e,t,a;for(a=[],e=0,t=o.length;e<t;e++)n=o[e],a.push({value:n.id,name:n.name});return a}(),autofocus:!0}],e.pick_company_form={},e.submit=function(e){return t.close(e.company_id)},e.cancel=function(){return t.dismiss("cancel")}},r=function(t){var n,r,s,c,m;return o.bb||(o.bb={}),(n=o.bb).api_url||(n.api_url=t.apiUrl),(r=o.bb).api_url||(r.api_url="http://www.bookingbug.com"),s=function(){var o;return o=e.open({templateUrl:"login_modal_form.html",controller:d,resolve:{company_id:function(){return t.companyId}}}),o.result.then(function(e){return t.adminEmail=e.email,t.adminPassword=e.password,e.$has("admins")?e.$get("admins").then(function(e){var o;return t.admins=e,i.all(function(){var t,n,a;for(a=[],t=0,n=e.length;t<n;t++)o=e[t],a.push(o.$get("company"));return a}()).then(function(e){return c(e)})}):t.admin=e},function(){return s()})},c=function(o){var i;return i=e.open({templateUrl:"pick_company_modal_form.html",controller:l,resolve:{companies:function(){return o}}}),i.result.then(function(e){return t.companyId=e,m()},function(){return c()})},m=function(){var e,o;return e={email:t.adminEmail,password:t.adminPassword},o={company_id:t.companyId},a.Admin.Login.$login(e,o).then(function(e){return e.$has("admins")?e.$get("admins").then(function(e){var o;return t.admins=e,i.all(function(){var t,n,a;for(a=[],t=0,n=e.length;t<n;t++)o=e[t],a.push(o.$get("company"));return a}()).then(function(e){return c(e)})}):t.admin=e},function(){return s()})},t.adminEmail&&t.adminPassword?m():s()},{link:r,scope:{adminEmail:"@",adminPassword:"@",companyId:"@",apiUrl:"@",admin:"="},transclude:!0,template:"<div ng-hide='admin'><img src='/BB_wait.gif' class=\"loader\"></div>\n<div ng-show='admin' ng-transclude></div>"}}])}.call(this),function(){'use strict';angular.module("BBAdmin.Directives").directive("bbAdminSsoLogin",["$rootScope","BBModel","QueryStringService","halClient",function(e,t,o,i){return{restrict:"EA",scope:{token:"@bbAdminSsoLogin",companyId:"@",apiUrl:"@"},transclude:!0,template:"<div ng-if='admin' ng-transclude></div>",link:function(n){var a,r,d;return n.qs=o,r={},n.qs&&(r.token=n.qs("sso_token")),n.token&&(r.token||(r.token=n.token)),n.apiUrl&&(a=n.apiUrl),a||(a=e.bb.api_url),d=a+"/api/v1/login/admin_sso/"+n.companyId,i.$post(d,{},r).then(function(e){var o;return o={auth_token:e.auth_token},e.$get("administrator",o).then(function(e){return n.admin=e,t.Admin.Login.$setLogin(e)})})}}}])}.call(this),function(){'use strict';angular.module("BBAdmin").directive("bookingTable",["BBModel","ModalForm",function(e,t){var o,i;return o=function(o){return o.fields=["id","datetime"],o.getBookings=function(){var t;return t={company:o.company},e.Admin.Booking.$query(t).then(function(e){return o.bookings=e.items})},o.newBooking=function(){return t["new"]({company:o.company,title:"New Booking",new_rel:"new_booking",post_rel:"bookings",success:function(e){return o.bookings.push(e)}})},o.edit=function(e){return t.edit({model:e,title:"Edit Booking"})}},i=function(t,o,i){return t.company?t.getBookings():e.Admin.Company.$query(i).then(function(e){return t.company=e,t.getBookings()})},{controller:o,link:i,templateUrl:"booking_table_main.html"}}])}.call(this),function(){'use strict';angular.module("BBAdmin.Directives").directive("bbPeopleList",["$rootScope",function(){return{restrict:"AE",replace:!0,scope:!0,controller:["$scope","$rootScope","PersonService","$q","BBModel","PersonModel",function(e,t){return t.connection_started.then(function(){return e.bb.company.$getPeople().then(function(t){var o,n,a,r;for(e.people=t,r=[],(o=0,n=t.length);o<n;o++)a=t[o],r.push(a.show=!0);return r})}),e.show_all_people=function(){var t,o,n,a,r;for(n=e.people,a=[],(t=0,o=n.length);t<o;t++)r=n[t],a.push(r.show=!0);return a},e.hide_all_people=function(){var t,o,n,a,r;for(n=e.people,a=[],(t=0,o=n.length);t<o;t++)r=n[t],a.push(r.show=!1);return a}}],link:function(){}}}]),angular.module("BBAdmin.Directives").directive("bbBookingList",function(){return{restrict:"AE",replace:!0,scope:{bookings:"=",cancelled:"=",params:"="},templateUrl:function(e,t){return t.template},controller:["$scope","$filter",function(e,t){var o;return e.title=e.params.title,o=e.params.status,e.$watch(function(){return e.bookings},function(){var i,n;return i=e.bookings,n=e.cancelled,null==n&&(n=!1),null!=i&&(i=t("filter")(i,function(e){var t;return t=e.is_cancelled===n,t&=null==o?null==e.multi_status||0===Object.keys(e.multi_status).length:e.hasStatus(o),t&=4===e.status,t}),e.relevantBookings=t("orderBy")(i,"datetime")),null==e.relevantBookings?e.relevantBookings=[]:e.relevantBookings})}]}})}.call(this),function(){'use strict';var e;e=angular.module("BBAdmin.Filters",[]),e.filter("rag",function(){return function(e,t,o){return e<=t?"red":e<=o?"amber":"green"}}),e.filter("gar",function(){return function(e,t,o){return e<=t?"green":e<=o?"amber":"red"}}),e.filter("time",["$window",function(e){return function(t){return e.sprintf("%02d:%02d",Math.floor(t/60),t%60)}}])}.call(this),function(){'use strict';var e=function(e,o){function i(){this.constructor=e}for(var n in o)t.call(o,n)&&(e[n]=o[n]);return i.prototype=o.prototype,e.prototype=new i,e.__super__=o.prototype,e},t={}.hasOwnProperty;angular.module("BB.Models").factory("AdminAdministratorModel",["$q","BBModel","BaseModel",function(t,o,i){var n;return n=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o}(i)}])}.call(this),function(){'use strict';var e=Math.floor,t=function(e,t){function i(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},o={}.hasOwnProperty;angular.module("BB.Models").factory("AdminBookingModel",["$q","BBModel","BaseModel","BookingCollections","$window",function(o,n,a,r,d){var l;return l=function(i){function a(){var e,t,o;if(a.__super__.constructor.apply(this,arguments),this.datetime=moment(this.datetime),this.start=this.datetime,this.end=this.end_datetime,this.end||(this.end=this.datetime.clone().add(this.duration,"minutes")),this.title=this.full_describe,this.time=60*this.start.hour()+this.start.minute(),this.allDay=!1,this.duration_span&&86400===this.duration_span&&(this.allDay=!0),3===this.status?(this.startEditable=!0,this.durationEditable=!0,this.className="status_blocked"):4===this.status?this.className="status_booked":0===this.status&&(this.className="status_available"),this.multi_status)for(e in t=this.multi_status,t)o=t[e],this.className+=" status_"+e}return t(a,i),a.prototype.useFullTime=function(){if(this.using_full_time=!0,this.pre_time&&(this.start=this.datetime.clone().subtract(this.pre_time,"minutes")),this.post_time)return this.end=this.datetime.clone().add(this.duration+this.post_time,"minutes")},a.prototype.getPostData=function(){var e,t;return e={},this.date&&this.time?(e.date=this.date.date.toISODate(),e.time=this.time.time,this.time.event_id?e.event_id=this.time.event_id:this.time.event_ids&&(e.event_ids=this.time.event_ids)):(this.datetime=this.start.clone(),this.using_full_time&&this.datetime.add(this.pre_time,"minutes"),e.date=this.datetime.format("YYYY-MM-DD"),e.time=60*this.datetime.hour()+this.datetime.minute()),e.duration=this.duration,e.id=this.id,e.pre_time=this.pre_time,e.post_time=this.post_time,e.person_id=this.person_id,e.resource_id=this.resource_id,e.child_client_ids=this.child_client_ids,e.people_ids=this.people_ids,this.questions&&(e.questions=function(){var e,o,n,a;for(n=this.questions,a=[],(e=0,o=n.length);e<o;e++)t=n[e],a.push(t.getPostData());return a}.call(this)),e},a.prototype.hasStatus=function(e){return null!=this.multi_status[e]},a.prototype.statusTime=function(e){return this.multi_status[e]?moment(this.multi_status[e]):null},a.prototype.sinceStatus=function(t){var o;return o=this.statusTime(t),o?e((moment().unix()-o.unix())/60):0},a.prototype.sinceStart=function(t){var o,i;return i=this.datetime.unix(),t?t.later&&(o=this.statusTime(t.later).unix(),o>i)?e((moment().unix()-o)/60):t.earlier&&(o=this.statusTime(t.earlier).unix(),o<i)?e((moment().unix()-o)/60):e((moment().unix()-i)/60):e((moment().unix()-i)/60)},a.prototype.answer=function(e){var t,o,n,r;if(this.answers_summary)for(r=this.answers_summary,o=0,n=r.length;o<n;o++)if(t=r[o],t.name===e)return t.answer;return null},a.prototype.$update=function(e){var t;return t=o.defer(),e&&(e.datetime=moment(e.datetime),e.datetime.tz(),e.datetime=e.datetime.format()),e||(e=this.getPostData()),this.$put("self",{},e).then(function(e){return function(o){return e.constructor(o),e.using_full_time&&e.useFullTime(),r.checkItems(e),t.resolve(e)}}(this),function(e){return t.reject(e)}),t.promise},a.prototype.$refetch=function(){var e;return e=o.defer(),this.$flush("self"),this.$get("self").then(function(t){return function(o){return t.constructor(o),t.using_full_time&&t.useFullTime(),r.checkItems(t),e.resolve(t)}}(this),function(t){return e.reject(t)}),e.promise},a.$query=function(e){var t,i,a,l;return e.slot&&(e.slot_id=e.slot.id),e.date&&(e.start_date=e.date,e.end_date=e.date),e.company&&(t=e.company,delete e.company,e.company_id=t.id),null==e.per_page&&(e.per_page=1024),null==e.include_cancelled&&(e.include_cancelled=!1),i=o.defer(),a=r.find(e),a&&!e.skip_cache?i.resolve(a):(l=t,l||(l=e.src),e.src&&delete e.src,e.skip_cache&&(a&&r["delete"](a),l.$flush("bookings",e)),l.$get("bookings",e).then(function(t){var o;return t.$has("bookings")?t.$get("bookings").then(function(o){var a,l,s;return l=function(){var e,t,r;for(r=[],e=0,t=o.length;e<t;e++)a=o[e],r.push(new n.Admin.Booking(a));return r}(),s=new d.Collection.Booking(t,l,e),r.add(s),i.resolve(s)},function(e){return i.reject(e)}):(o=new n.Admin.Booking(t),i.resolve(o))},function(e){return i.reject(e)})),i.promise},a}(a)}])}.call(this),function(){'use strict';var e=function(e,o){function i(){this.constructor=e}for(var n in o)t.call(o,n)&&(e[n]=o[n]);return i.prototype=o.prototype,e.prototype=new i,e.__super__=o.prototype,e},t={}.hasOwnProperty;angular.module("BB.Models").factory("AdminClientModel",["ClientModel","$q","BBModel","$log","$window","ClientCollections","$rootScope","UriTemplate","halClient",function(t,o,n,a,r,d,l,s,c){var m;return m=function(t){function i(e){i.__super__.constructor.call(this,e)}return e(i,t),i.$query=function(e){var t,i,m,p,u;return t=e.company,i=o.defer(),t.$has("client")?(u="",l.bb.api_url&&(u=l.bb.api_url),m=u+"/api/v1/admin/{company_id}/client{/id}{?page,per_page,filter_by,filter_by_fields,order_by,order_by_reverse,search_by_fields,default_company_id}",e.company_id=t.id,p=new s(m).fillFromObject(e||{}),e.flush&&c.clearCache(p),c.$get(p,{}).then(function(){return function(t){var o;return t.$has("clients")?t.$get("clients").then(function(o){var a,l;return l=function(){var e,t,r;for(r=[],e=0,t=o.length;e<t;e++)a=o[e],r.push(new n.Admin.Client(a));return r}(),o=new r.Collection.Client(t,l,e),o.total_entries=t.total_entries,d.add(o),i.resolve(o)},function(e){return i.reject(e)}):(o=new n.Admin.Client(t),i.resolve(o))}}(this),function(e){return i.reject(e)})):(a.warn("company has no client link"),i.reject("company has no client link")),i.promise},i}(t)}])}.call(this),function(){'use strict';var e=function(e,o){function i(){this.constructor=e}for(var n in o)t.call(o,n)&&(e[n]=o[n]);return i.prototype=o.prototype,e.prototype=new i,e.__super__=o.prototype,e},t={}.hasOwnProperty;angular.module("BB.Models").factory("AdminCompanyModel",["CompanyModel","AdminCompanyService","BookingCollections","$q","BBModel",function(t,o,i,n,a){var r;return r=function(t){function r(e){r.__super__.constructor.call(this,e)}return e(r,t),r.prototype.getBooking=function(e){var t;return t=n.defer(),this.$get("bookings",{id:e}).then(function(e){var o;return o=new a.Admin.Booking(e),i.checkItems(o),t.resolve(o)},function(e){return t.reject(e)}),t.promise},r.$query=function(e){return o.query(e)},r}(t)}])}.call(this),function(){'use strict';var e=function(e,o){function i(){this.constructor=e}for(var n in o)t.call(o,n)&&(e[n]=o[n]);return i.prototype=o.prototype,e.prototype=new i,e.__super__=o.prototype,e},t={}.hasOwnProperty;angular.module("BB.Models").factory("AdminLoginModel",["$q","AdminLoginService","BBModel","BaseModel",function(t,o,i,n){var a;return a=function(t){function i(e){i.__super__.constructor.call(this,e)}return e(i,t),i.$login=function(e,t){return o.login(e,t)},i.$ssoLogin=function(e,t){return o.ssoLogin(e,t)},i.$isLoggedIn=function(){return o.isLoggedIn()},i.$setLogin=function(e){return o.setLogin(e)},i.$user=function(){return o.user()},i.$checkLogin=function(e){return o.checkLogin(e)},i.$logout=function(){return o.logout()},i.$getLogin=function(e){return o.getLogin(e)},i.$companyLogin=function(e,t){return o.companyLogin(e,t)},i.$memberQuery=function(e){return o.memberQuery(e)},i.$setCompany=function(e){return o.setCompany(e)},i}(n)}])}.call(this),function(){'use strict';var e=function(e,o){function i(){this.constructor=e}for(var n in o)t.call(o,n)&&(e[n]=o[n]);return i.prototype=o.prototype,e.prototype=new i,e.__super__=o.prototype,e},t={}.hasOwnProperty;angular.module("BB.Models").factory("AdminSlotModel",["$q","BBModel","BaseModel","TimeSlotModel","SlotCollections","$window",function(t,o,i,n,a,r){var d;return d=function(i){function n(e){var t,o,i;if(n.__super__.constructor.call(this,e),this.title=this.full_describe,0===this.status&&(this.title="Available"),this.datetime=moment(this.datetime),this.start=this.datetime,this.end=this.end_datetime,this.end=this.datetime.clone().add(this.duration,"minutes"),this.time=60*this.start.hour()+this.start.minute(),this.title=this.full_describe,this.allDay=!1,this.duration_span&&86400===this.duration_span&&(this.allDay=!0),3===this.status?(this.startEditable=!0,this.durationEditable=!0,this.className="status_blocked"):4===this.status?this.className="status_booked":0===this.status&&(this.className="status_available"),this.multi_status)for(t in o=this.multi_status,o)i=o[t],this.className+=" status_"+t}return e(n,i),n.prototype.useFullTime=function(){if(this.using_full_time=!0,this.pre_time&&(this.start=this.datetime.clone().subtract(this.pre_time,"minutes")),this.post_time)return this.end=this.datetime.clone().add(this.duration+this.post_time,"minutes")},n.prototype.$refetch=function(){var e;return e=t.defer(),this.$flush("self"),this.$get("self").then(function(t){return function(o){return t.constructor(o),t.using_full_time&&t.useFullTime(),BookingCollections.checkItems(t),e.resolve(t)}}(this),function(t){return e.reject(t)}),e.promise},n.$query=function(e){var i,n,d,l;return e.slot&&(e.slot_id=e.slot.id),e.date&&(e.start_date=e.date,e.end_date=e.date),e.company&&(i=e.company,delete e.company,e.company_id=i.id),null==e.per_page&&(e.per_page=1024),null==e.include_cancelled&&(e.include_cancelled=!1),n=t.defer(),d=a.find(e),d&&!e.skip_cache?n.resolve(d):(l=i,l||(l=e.src),e.src&&delete e.src,e.skip_cache&&(d&&a["delete"](d),l.$flush("slots",e)),l.$get("slots",e).then(function(t){var i;return t.$has("slots")?t.$get("slots").then(function(d){var l,i,s;return i=function(){var e,t,n;for(n=[],e=0,t=d.length;e<t;e++)l=d[e],n.push(new o.Admin.Slot(l));return n}(),s=new r.Collection.Slot(t,i,e),a.add(s),n.resolve(s)},function(e){return n.reject(e)}):(i=new o.Admin.Slot(t),n.resolve(i))},function(e){return n.reject(e)})),n.promise},n}(n)}])}.call(this),function(){'use strict';var e=function(e,o){function i(){this.constructor=e}for(var n in o)t.call(o,n)&&(e[n]=o[n]);return i.prototype=o.prototype,e.prototype=new i,e.__super__=o.prototype,e},t={}.hasOwnProperty;angular.module("BB.Models").factory("AdminUserModel",["$q","BBModel","BaseModel",function(t,o,i){var n;return n=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o}(i)}])}.call(this),function(){'use strict';angular.module("BBAdmin.Services").factory("AdminBookingService",["$q","$window","halClient","BookingCollections","BBModel","UriTemplate",function(e,t,o,n,a,r){return{query:function(d){var l,s,c,m,p,u;return d.slot&&(d.slot_id=d.slot.id),d.date&&(d.start_date=d.date,d.end_date=d.date),d.company&&(l=d.company,delete d.company,d.company_id=l.id),null==d.per_page&&(d.per_page=1024),null==d.include_cancelled&&(d.include_cancelled=!1),s=e.defer(),c=n.find(d),c&&!d.skip_cache?s.resolve(c):l?(d.skip_cache&&(c&&n["delete"](c),l.$flush("bookings",d)),l.$get("bookings",d).then(function(e){return e.$get("bookings").then(function(o){var r,i,l;return i=function(){var e,t,n;for(n=[],e=0,t=o.length;e<t;e++)r=o[e],n.push(new a.Admin.Booking(r));return n}(),l=new t.Collection.Booking(e,i,d),n.add(l),s.resolve(l)},function(e){return s.reject(e)})},function(e){return s.reject(e)})):(u="",d.url&&(u=d.url),m=u+"/api/v1/admin/{company_id}/bookings{?slot_id,start_date,end_date,service_id,resource_id,person_id,page,per_page,include_cancelled,embed,client_id}",p=new r(m).fillFromObject(d||{}),o.$get(p,{}).then(function(){return function(e){return e.$get("bookings").then(function(o){var r,l,c,m,p;for(m=[],r=0,c=o.length;r<c;r++)l=o[r],m.push(new a.Admin.Booking(l));return p=new t.Collection.Booking(e,m,d),n.add(p),s.resolve(p)})}}(this),function(){return function(e){return s.reject(e)}}(this))),s.promise},getBooking:function(t){var i,d,l,s;return i=e.defer(),t.company&&!t.company_id&&(t.company_id=t.company.id),s="",t.url&&(s=t.url),d=s+"/api/v1/admin/{company_id}/bookings/{id}{?embed}",l=new r(d).fillFromObject(t||{}),o.$get(l,{no_cache:!0}).then(function(e){var t;return t=new a.Admin.Booking(e),n.checkItems(t),i.resolve(t)},function(){return function(e){return i.reject(e)}}(this)),i.promise},cancelBooking:function(t,i){var d,l,s,c;return d=e.defer(),l="/api/v1/admin/{company_id}/bookings/{id}?notify={notify}",null==t.id&&(t.id=i.id),s=t.notify,null==s&&(s=!0),c=new r(l).fillFromObject(t||{}),o.$del(c,{notify:s}).then(function(e){return i=new a.Admin.Booking(e),n.checkItems(i),d.resolve(i)},function(){return function(e){return d.reject(e)}}(this)),d.promise},updateBooking:function(t,i){var d,l,s;return d=e.defer(),l="/api/v1/admin/{company_id}/bookings/{id}",null==t.id&&(t.id=i.id),s=new r(l).fillFromObject(t||{}),o.$put(s,{},t).then(function(e){return i=new a.Admin.Booking(e),n.checkItems(i),d.resolve(i)},function(){return function(e){return d.reject(e)}}(this)),d.promise},blockTimeForPerson:function(t,i){var d,l,s;return d=e.defer(),l="/api/v1/admin/{company_id}/people/{person_id}/block",null==t.person_id&&(t.person_id=i.id),t.booking=!0,s=new r(l).fillFromObject(t||{}),o.$put(s,{},t).then(function(e){var t;return t=new a.Admin.Booking(e),n.checkItems(t),d.resolve(t)},function(){return function(e){return d.reject(e)}}(this)),d.promise},addStatusToBooking:function(t,i,d){var l,s,c;return l=e.defer(),s="/api/v1/admin/{company_id}/bookings/{booking_id}/multi_status",null==t.booking_id&&(t.booking_id=i.id),c=new r(s).fillFromObject(t||{}),o.$put(c,{},{status:d}).then(function(e){return i=new a.Admin.Booking(e),n.checkItems(i),l.resolve(i)},function(){return function(e){return l.reject(e)}}(this)),l.promise},addPrivateNoteToBooking:function(t,i,d){var l,s,c,m;return l=e.defer(),s="/api/v1/admin/{company_id}/bookings/{booking_id}/private_notes",null==t.booking_id&&(t.booking_id=i.id),null!=d.note&&(c=d.note),null==c&&(c=d),m=new r(s).fillFromObject(t||{}),o.$put(m,{},{note:c}).then(function(e){return i=new a.Admin.Booking(e),n.checkItems(i),l.resolve(i)},function(){return function(e){return l.reject(e)}}(this)),l.promise},updatePrivateNoteForBooking:function(t,i,d){var l,s,c;return l=e.defer(),s="/api/v1/admin/{company_id}/bookings/{booking_id}/private_notes/{id}",null==t.booking_id&&(t.booking_id=i.id),null==t.id&&(t.id=d.id),c=new r(s).fillFromObject(t||{}),o.$put(c,{},{note:d.note}).then(function(e){return i=new a.Admin.Booking(e),n.checkItems(i),l.resolve(i)},function(){return function(e){return l.reject(e)}}(this)),l.promise},deletePrivateNoteFromBooking:function(t,i,d){var l,s,c;return l=e.defer(),s="/api/v1/admin/{company_id}/bookings/{booking_id}/private_notes/{id}",null==t.booking_id&&(t.booking_id=i.id),null==t.id&&(t.id=d.id),c=new r(s).fillFromObject(t||{}),o.$del(c,{}).then(function(e){return i=new a.Admin.Booking(e),n.checkItems(i),l.resolve(i)},function(){return function(e){return l.reject(e)}}(this)),l.promise}}}])}.call(this),function(){'use strict';angular.module("BBAdmin.Services").factory("ColorPalette",function(){var e;return e=[{primary:"#001F3F",secondary:"#80BFFF"},{primary:"#FF4136",secondary:"#800600"},{primary:"#7FDBFF",secondary:"#004966"},{primary:"#3D9970",secondary:"#163728"},{primary:"#85144B",secondary:"#EB7AB1"},{primary:"#2ECC40",secondary:"#0E3E14"},{primary:"#FF851B",secondary:"#663000"}],{setColors:function(t){return _.each(t,function(t,o){var i;return i=e[o%e.length],t.color=i.primary,t.textColor=i.secondary})}}})}.call(this),function(){'use strict';angular.module("BBAdmin.Services").factory("AdminCompanyService",["$q","$rootScope","$sessionStorage","BBModel",function(e,t,o,i){return{query:function(n){var a,r,d,l;return l=e.defer(),t.bb||(t.bb={}),(a=t.bb).api_url||(a.api_url=o.getItem("host")),(r=t.bb).api_url||(r.api_url=n.apiUrl),(d=t.bb).api_url||(d.api_url=""),i.Admin.Login.$checkLogin(n).then(function(){var e,o;return t.user&&t.user.company_id?(t.bb||(t.bb={}),t.bb.company_id=t.user.company_id,t.user.$get("company").then(function(e){return l.resolve(new i.Admin.Company(e))},function(e){return l.reject(e)})):(e={email:n.adminEmail,password:n.adminPassword},o={company_id:n.companyId},i.Admin.Login.$login(e,o).then(function(e){return e.$get("company").then(function(e){return l.resolve(new i.Admin.Company(e))},function(e){return l.reject(e)})},function(e){return l.reject(e)}))}),l.promise}}}])}.call(this),function(){'use strict';angular.module("BBAdmin.Services").factory("AdminDayService",["$q","$window","halClient","BBModel","UriTemplate",function(e,t,o,n,a){return{query:function(r){var d,l,s,c;return c="",r.url&&(c=r.url),l=c+"/api/v1/{company_id}/day_data{?month,week,date,edate,event_id,service_id}",s=new a(l).fillFromObject(r||{}),d=e.defer(),o.$get(s,{}).then(function(){return function(e){var i,a,l,s,c;if(e.items){for(s=[],c=e.items,(a=0,l=c.length);a<l;a++)i=c[a],o.$get(i.uri).then(function(e){var o,a,d,l,c,m;for(o=[],m=e.days,(l=0,c=m.length);l<c;l++)d=m[l],d.type===r.item&&o.push(new n.Day(d));return a=new t.Collection.Day(e,o,{}),s.push(a)});return d.resolve(s)}}}(this),function(){return function(e){return d.reject(e)}}(this)),d.promise}}}])}.call(this),function(){'use strict';angular.module("BBAdmin.Services").factory("AdminLoginService",["$q","halClient","$rootScope","BBModel","$sessionStorage","$cookies","UriTemplate","shared_header",function(e,t,o,i,n,a,r,d){return{login:function(n,a){var r,d;return r=e.defer(),d=o.bb.api_url+"/api/v1/login/admin",null!=a&&null!=a.company_id&&(d=d+"/"+a.company_id),t.$post(d,a,n).then(function(e){return function(t){var o;return t.$has("administrator")?t.$get("administrator").then(function(t){return t=e.setLogin(t),r.resolve(t)}):t.$has("administrators")?(o=new i.Admin.Login(t),r.resolve(o)):r.reject("No admin account for login")}}(this),function(){return function(e){var o,n;return 400===e.status?(o=t.$parse(e.data),o.$has("administrators")?(n=new i.Admin.Login(o),r.resolve(n)):r.reject(e)):r.reject(e)}}(this)),r.promise},ssoLogin:function(i,n){var a,r;return a=e.defer(),r=o.bb.api_url+"/api/v1/login/sso/"+i.company_id,t.$post(r,{},n).then(function(e){return function(t){var o;return o={auth_token:t.auth_token},t.$get("user").then(function(t){return t=e.setLogin(t),a.resolve(t)})}}(this),function(){return function(e){return a.reject(e)}}(this)),a.promise},isLoggedIn:function(){var t;return t=e.defer(),this.checkLogin().then(function(){return o.user?t.resolve(!0):t.reject(!1)},function(){return t.reject(!1)}),t.promise},setLogin:function(e){var t;return e=new i.Admin.User(e),t=e.getOption("auth_token"),n.setItem("user",e.$toStore()),n.setItem("auth_token",t),o.user=e,e},user:function(){return this.checkLogin().then(function(){return o.user})},checkLogin:function(d){var l,s,c,m,p,u;return null==d&&(d={}),s=e.defer(),o.user&&s.resolve(),u=n.getItem("user"),u?(o.user=new i.Admin.User(t.createResource(u)),s.resolve()):(l=a.get("Auth-Token"),l?(p=o.bb.api_url?o.bb.api_url+"/api/v1/login{?id,role}":"/api/v1/login{?id,role}",d.id=d.companyId||d.company_id,d.role="admin",c=new r(p).fillFromObject(d||{}),m={auth_token:l},t.$get(c,m).then(function(){return function(e){return e.$has("administrator")?e.$get("administrator").then(function(e){return o.user=new i.Admin.User(e),s.resolve()}):s.resolve()}}(this),function(){return s.resolve()})):s.resolve()),s.promise},logout:function(){var i,r;return i=e.defer(),r=o.bb.api_url+"/api/v1/login",t.$del(r)["finally"](function(){return o.user=null,n.removeItem("user"),n.removeItem("auth_token"),a.remove("Auth-Token"),d.del("auth_token"),i.resolve()},function(){return i.reject()}),i.promise},getLogin:function(i){var n,a;return n=e.defer(),a=o.bb.api_url+"/api/v1/login/admin/"+i.company_id,t.$get(a,i).then(function(e){return function(t){return t.$has("administrator")?t.$get("administrator").then(function(t){return t=e.setLogin(t),n.resolve(t)},function(e){return n.reject(e)}):n.reject()}}(this),function(e){return n.reject(e)}),n.promise},setCompany:function(i){var n,a,r;return n=e.defer(),r=o.bb.api_url+"/api/v1/login/admin",a={company_id:i},t.$put(r,{},a).then(function(e){return function(t){return t.$has("administrator")?t.$get("administrator").then(function(t){return t=e.setLogin(t),n.resolve(t)},function(e){return n.reject(e)}):n.reject()}}(this),function(e){return n.reject(e)}),n.promise}}}])}.call(this),function(){'use strict';angular.module("BBAdmin.Services").factory("AdminPurchaseService",["$q","halClient","BBModel",function(e,t,o){return{query:function(i){var n,a;return n=e.defer(),a=i.url_root+"/api/v1/admin/purchases/"+i.purchase_id,t.$get(a,i).then(function(e){return e=new o.Purchase.Total(e),n.resolve(e)},function(e){return n.reject(e)}),n.promise},markAsPaid:function(i){var n,a,r,d;return(r=e.defer(),!i.purchase||!i.url_root)?(r.reject("invalid request"),r.promise):(i.company&&(n=i.company.id),d=i.url_root+("/api/v1/admin/"+n+"/purchases/"+i.purchase.id+"/pay"),a={},i.company&&(a.company_id=i.company.id),i.notify_admin&&(a.notify_admin=i.notify_admin),i.payment_status&&(a.payment_status=i.payment_status),i.amount&&(a.amount=i.amount),i.notes&&(a.notes=i.notes),i.transaction_id&&(a.transaction_id=i.transaction_id),i.notify&&(a.notify=i.notify),i.payment_type&&(a.payment_type=i.payment_type),t.$put(d,i,a).then(function(e){return e=new o.Purchase.Total(e),r.resolve(e)},function(e){return r.reject(e)}),r.promise)}}}])}.call(this),function(){'use strict';angular.module("BBAdmin.Services").factory("AdminSlotService",["$q","$window","halClient","SlotCollections","BBModel","UriTemplate",function(e,t,o,n,a,r){return{query:function(d){var l,s,c,m,p;return l=e.defer(),s=n.find(d),s?l.resolve(s):d.user?d.user.$get("company").then(function(e){return e.$get("slots",d).then(function(e){return e.$get("slots").then(function(e){var t,o;return o=function(){var o,n,r;for(r=[],o=0,n=e.length;o<n;o++)t=e[o],r.push(new a.Admin.Slot(t));return r}(),l.resolve(o)},function(e){return l.reject(e)})})}):(p="",d.url&&(p=d.url),c=p+"/api/v1/admin/{company_id}/slots{?start_date,end_date,date,service_id,resource_id,person_id,page,per_page}",m=new r(c).fillFromObject(d||{}),o.$get(m,{}).then(function(){return function(e){return e.$get("slots").then(function(o){var r,s,c,m,p;for(m=[],r=0,c=o.length;r<c;r++)s=o[r],m.push(new a.Admin.Slot(s));return p=new t.Collection.Slot(e,m,d),n.add(p),l.resolve(p)})}}(this),function(){return function(e){return l.reject(e)}}(this))),l.promise},create:function(t,i){var d,l,s,c;return c="",t.url&&(c=t.url),l=c+"/api/v1/admin/{company_id}/slots",s=new r(l).fillFromObject(t||{}),d=e.defer(),o.$post(s,{},i).then(function(){return function(e){return e=new a.Admin.Slot(e),n.checkItems(e),d.resolve(e)}}(this),function(){return function(e){return d.reject(e)}}(this)),d.promise},delete:function(t){var o;return o=e.defer(),t.$del("self").then(function(){return function(e){return e=new a.Admin.Slot(e),n.deleteItems(e),o.resolve(e)}}(this),function(){return function(e){return o.reject(e)}}(this)),o.promise},update:function(t,o){var i;return i=e.defer(),t.$put("self",{},o).then(function(){return function(e){return e=new a.Admin.Slot(e),n.checkItems(e),i.resolve(e)}}(this),function(){return function(e){return i.reject(e)}}(this)),i.promise}}}])}.call(this),function(){'use strict';angular.module("BBAdmin.Services").factory("AdminTimeService",["$q","$window","halClient","BBModel","UriTemplate",function(e,t,o,n,a){return{query:function(t){var r,d,l,s;return t.day&&(t.date=t.day.date),!t.edate&&t.date&&(t.edate=t.date),s="",t.url&&(s=t.url),d=s+"/api/v1/{company_id}/time_data{?date,event_id,service_id,person_id}",l=new a(d).fillFromObject(t||{}),r=e.defer(),o.$get(l,{no_cache:!1}).then(function(){return function(e){return e.$get("events").then(function(t){var o,a,d,l,s,c,m,p,u,y;for(d=[],l=0,c=t.length;l<c;l++){for(a=t[l],o={},o.times=[],o.event_id=a.event_id,o.person_id=e.person_id,p=a.times,(s=0,m=p.length);s<m;s++)u=p[s],y=new n.TimeSlot(u),o.times.push(y);d.push(o)}return r.resolve(d)})}}(this),function(){return function(e){return r.reject(e)}}(this)),r.promise}}}])}.call(this),function(){'use strict';angular.module("BB.Services").factory("BB.Service.login",["$q","BBModel",function(e,t){return{unwrap:function(e){return new t.Admin.Login(e)}}}]),angular.module("BB.Services").factory("BB.Service.base_login",["$q","BBModel",function(e,t){return{unwrap:function(e){return new t.Admin.Login(e)}}}])}.call(this),function(){"use strict";angular.module("BBAdmin").config(["$translateProvider",function(e){"ngInject";var t;t={ADMIN:{CANCEL_BOOKING_MODAL:{TITLE:"Cancel Booking",REASON_LBL:"Cancel reason",SEND_EMAIL_LBL:"Send cancellation confirmation to {{email}}?",OK_BTN:"@:COMMON.BTN.OK",CLOSE_BTN:"@:COMMON.BTN.CLOSE"},LOGIN:{EMAIL_LBL:"@:COMMON.TERMINOLOGY.EMAIL",EMAIL_PLACEHOLDER:"@:COMMON.TERMINOLOGY.EMAIL",PASSWORD_LBL:"@:COMMON.FORM.PASSWORD",PASSWORD_PLACEHOLDER:"@:COMMON.FORM.PASSWORD",LOGIN_BTN:"@:COMMON.BTN.LOGIN"},PICK_COMPANY:{STEP_SUMMARY:"Pick Company",SELECT_BTN:"@:COMMON.BTN.SELECT"},BOOKNG_TABLE:{NEW_BOOKING_BTN:"New booking",EDIT_BTN:"@:COMMON.BTN.EDIT"}}},e.translations("en",t)}])}.call(this);